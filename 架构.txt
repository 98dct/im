项目架构：
api模块：充当BFF层，作为网关的后端
rpc模块：被api模块调用

项目目录结构：
apps:   应用目录，记录相关服务信息
- user:
    - api:
    - rpc:
- im
deploy          项目部署相关信息 sql or dockerfile
pkg
docker-compose.yaml
Makefile      编译脚本

网关的作用：
1.反向代理、负载均衡
2.请求转发，根据不同的请求路径、请求头转发到不同的后端服务
3.支持不同的协议转换  http到websocket、grpc
4.认证、授权
5.熔断、限流、重试

项目三大业务
用户：
    登入、注册、详情、查找
社交【好友、群】：
    好友：好友添加(好友申请、好友申请处理)、好友列表
    群：进群、退群、列表
聊天：
    私聊、群聊、聊天记录等

基础环境：
机器：
    虚拟机：192.168.8.100
代码仓库：
    github托管
镜像仓库：
   阿里云个人镜像仓库
   docker pull xxx 时根据是否指定仓库地址决定从私有仓库还是公共仓库拉取镜像

chmod 777 -R ./components  递归给目录赋予权限
docker run -d --name xxx --restart=always  nginx:latest   指定容器自动重启
docker update --restart=always xxx      更新容器为自动重启

md5加密：不加盐的单向hash，不可逆，同一个密码经过hash后生成同一个hash值(32位)，加密速度快
bcrypt加密：加盐、加cost的单向hash，不可逆，同一密码每次加密后生成的值都不一样(60位)，加密速度慢

一致性级别：
强一致性：金融交易、在线支付
弱一致性：网站评论、社交平台
最终一致性：数据复制、同步、日志统计

先删除缓存、后更新数据、
延迟双删：先删缓存、在删数据库、等待N秒、再删缓存
第二次删缓存可以用异步执行，配合重试机制使用

先更新数据、后删除缓存


最终一致性：
先更新数据库、然后将删除缓存的动作放到异步任务队列中去执行，缺点：代码耦合
先更新数据库、然后使用cannel监听binlog日志，在删除缓存，优点：无代码耦合


建立两个人的好友关系，怎样存储关系？
1.冗余存储，A--B B--A 好处：简单明了，查询快速，缺点：存在冗余
2.计算唯一key, A,B的user id合成一个唯一key，根据key查询

go-zero內部采用grpc来作为rpc通信，使用etcd作为注册、发现中心
grpc采用去中心化思想，在客户端实现负载均衡
zookeeper：
优点：基于java开发、服务稳定，功能齐全
缺点：复杂度大、维护难度大，比较重
etcd: 使用go语言开发，采用键值对存储数据，是一个分布式，强一致性，具有监听机制的配置系统
consul: 使用go语言开发，支持键值对、列表和树等多种数据结构，提供服务发现和健康检查机制
是中心化的服务发现系统。

客户端发现：etcd，客户端从注册中心获取服务端服务列表信息，客户端内部实现负载均衡机制。
中心化发现：consul，客户端只需要知道中心的地址，有中心实现负载均衡。

无状态负载均衡：
有状态负载均衡：相比有状态多了请求-响应数据的记录和数据的计算

轮询、随机、哈希、权重

go-zero采用p2c + EWMA